\chapter{Algebraic Integers}
	\setcounter{page}{1}
	\pagenumbering{arabic}
	\section{Integral closure and algebraic integers}
		Here we present fundamental properties of algebraic integers and related theories. It is not our intention to do a treatise of commutative algebra and Galois theory, so for example there would not be the fundamental theorem of Galois theory, or the definition of Dedekind domain. However, if some theorems are explicitly useful in the future, you will still see the theorem and the proof.
		\subsection{Definition and examples}
			Problems in solving polynomial equations give rise to a lot of concepts in algebra and geometry. If we are specifically interested in $\mds{Z}$, we have the concept of \textbf{algebraic integers}.
			\begin{definition}
				A finite extension $K$ of the rational number $\mds{Q}$ is called a \textbf{number field}. The integral closure of $\mds{Z}$ in $K$ is called the ring of \textbf{algebraic integers} of $K$, and is denoted by $\OK$. To be precise, every element $x \in \OK$ is a zero of a monic polynomial $f \in \Z[X].$
			\end{definition}
			
			For this concept we have a lot of classic examples:
			
			\begin{example}
				If $K=\Q$, then $\OK$ is simply $\Z$. This is intuitive because suppose $x=a/b \in \Q$ is integral over $\Z$ where $(a,b)=1$, then
				\[
				x^n+c_1x^{n-1}+\cdots+c_n = 0
				\]
				where $c_i \in \Z$. Multiplying by $b^n$ yields
				\[
				a^n+c_1a^{n-1}b+\cdots+c_nb = 0
				\]
				Hence $b$ divides $a^n$. But we also have $(a^n,b)=1$, hence $b=\pm 1$, which is to say $x \in \Z$.
				
				There is an more general setting. Since $\Z$ is a unique factorial domain (UFD), and UFD is integrally closed \href{https://proofwiki.org/wiki/Unique_Factorization_Domain_is_Integrally_Closed}{[proof]}, we have $\Z=\OK$. 
			\end{example}
			
			\begin{example}
				The Gaussian rational $\Q(i)=K$. Indeed it is natural to consider Gaussian integer $\Z[i]$ first. For any $z=m+ni \in \Z[i]$, we have
				\[
				z^2-2mz+m^2+n^2=0
				\]
				Hence $\Z[i] \subset \OK$. The converse is similar to our proof when $K=\Q$.
			\end{example}
			
			\begin{example}
				Quadratic field $K=\Q(\sqrt{d})$, where $d$ is a square-free integer $>1$. This time the algebraic integer ring is different from what you may have thought: $\OK = \Z[\omega]$ where
				\[
				\omega = \begin{cases}
					\frac{1+\sqrt{d}}{2}, &\quad d = 4k+1, \\
					\sqrt{d}, &\quad \text{otherwise}.
				\end{cases}
				\]
			\end{example}
			It turns out we are studying polynomials such as
			\begin{itemize}
				\item $x^2+1=0$.
				\item $x^2-d=0$.
			\end{itemize}
			It also turns out that many properties are not restricted to $\Z$, but to a specific class of rings. Hence we will investigate some properties in the sense of commutative ring theory. The next example deserves more discussion.
			
			\subsubsection{The Cyclotomic Fields}
				Let $\omega = e^{2\pi i/m}$. This is the $m$-th root of $1$. If $\lambda$ is a conjugate of $\omega$, i.e. they both are roots of the same irreducible polynomial over $\Q$, then $\lambda$ is also an $m$-th root of $1$ and is not an $n$-th root of $1$ whenever $n<m$. If we find these $\lambda$, we have a better understanding of $\Q(\omega)$, which is called the cyclotomic field.
				
				For a specific field $k$, the question arises whether the image of $\gal(K(\omega)/K)$ in $(\Z/n\Z)^\ast$ is all of $(\Z/n\Z)^\ast$. Looking at $k=\mathds{R}$ or $k=\mathds{C}$, this is not always the case. We give an example on when it is the case.
				\begin{theorem}
					Let $\omega$ be a $m$-th root of unity, then
					\[
						[\Q(\omega):\Q] = \varphi(m)
					\]
					where $\varphi$ is the Euler function.
				\end{theorem}
				\begin{proof}
					Let $f(X)$ be the minimal polynomial of $\omega$ over $\Q$. Then $f(X)$ divides $X^m-1$, and we can write $X^m-1=f(X)h(X)$, where both $f$ and $h$ have leading coefficient $1$. By the Gauss lemma, $f$ and $h$ have integral coefficients. We shall now prove that if $p$ is a prime number not dividing $n$, then $\omega^p$ is also a root of $f$.
					
					% TODO: Finish the proof
				\end{proof}
				\begin{corollary}
					We have an isomorphism
					\[
						\gal(\Q(\omega):\Q) \cong (\Z/n\Z)^\ast.
					\]
				\end{corollary}
			
				\begin{corollary}
					If $n,m$ are relative prime integers $\ge 1$, then
					\[
						\Q(\omega_n) \cap \Q(\omega_m) = \Q.
					\]
				\end{corollary}
			
				We will prove that the cyclotomic integers (i.e. the algebraic integer with respect to $\Q(\omega)/\Q$) is actually $\Z[\omega]$. This is a highly non-trivial result and we can only deliver the proof after further study on prime ideals.
				% TODO: Finish this section and the study of Z[\omega]. Source can be found on Daniel A. Marcus.
		\subsection{Algebraic extension and integral closure}
			First of all we show that being algebraic almost implies being integral. 
			\begin{lemma}\label{alg-int}
				Let $A$ be a domain, $K$ its quotient field, and $x$ algebraic over $K$. Then there exists an element $c \ne 0$ of $A$ such that $cx$ is integral over $A$.
			\end{lemma}
			\begin{proof}
				Since $x$ is algebraic, we have an equation
				\[
					a_nx^n+\cdots+a_0=0
				\]
				with $a_i \in A$ and $a_n \ne 0$. Hence
				\[
					a_n^{n-1}(a_nx^n+\cdots+a_0)=(a_nx)^n+\cdots+a_0a_n^{n-1}=0
				\]
				which is to say $a_nx$ is integral over $A$. 
			\end{proof}
			
			Since finite extensions are algebraic, we are always free to use this lemma for the topic of number field.
			
			\begin{theorem}\label{closure-f-g}
				Let $A$ be an integrally closed Noetherian ring. Let $L$ be a finite separable extension of its quotient field $K$. Then the integral closure of $A$ in $L$ is finitely generated over $A$.
			\end{theorem}
		
			By being integrally closed we mean the ring is integrally closed in its quotient field. Some mathematicians also say it is being normal, but I think \textit{normal} does not carry a lot of information.
			
			\begin{proof}
				Since $A$ is Noetherian, all submodules of a finitely generated module over $A$ is finitely generated. Hence it suffices to prove that the integral closure of $A$ is contained in a finitely generated $A$-module.\\
				Let $w_1,\dots,w_n$ be a basis of $L$ over $K$. After multiplying each $w_i$ by some suitable element of $A$ (see lemma \ref{alg-int}), we may assume without loss of generality that the $w_i$ are integral over $A$. To study the integral closure of $A$ in $L$, we pick an arbitrary element $z = b_1w_1+\cdots+b_nw_n$ and study its coefficients. \\
				Since $L/K$ is separable, the \href{https://stacks.math.columbia.edu/tag/0BIF}{field trace} form
				\[
					Q_{L/K}:L \times L \to K, \quad (x,y) \mapsto \tr_{L/K}(xy)
				\]
				is non-degenerate  \href{https://stacks.math.columbia.edu/tag/0BIL}{[proof]}, so we claim that $L^\ast$ is isomorphic to $L$ under $Q_{L/K}$. Indeed, one can define a $K$-linear map
				\[
					d:L \to L^\ast, \quad x \mapsto (y \mapsto Q_{L/K}(x,y)=\tr(xy)).
				\]
				This map is injective because $Q_{L/K}$ is non-degenerate. Since $L$ and $L^\ast$ has the same dimension, $d$ has to be surjective.\\
				Let $w^1,\dots,w^n$ be the dual basis of $w_1,\dots,w_n$. If we put $v_i=d^{-1}(w^i)$, we have
				\[
					\tr(v_i w_j) = \delta_{ij}.
				\]
				Let $c \ne 0$ be an element of $A$ such that $cv_i$ is integral over $A$, then $cv_iz$ is integral and so is $\tr(cv_iz)$. Since $\tr$ is a $K$-valued function, we have
				\[
					\tr(czv_i)=c\tr(v_iz)=c d(v_i)(z) = cb_i \in A \implies b_i \in Ac^{-1}.
				\]
				Hence
				\[
					z \in Ac^{-1}w_1+\cdots+Ac^{-1}w_n
				\]
				which is to say $z$ is finitely generated. Since $z$ is arbitrarily picked, the closure itself is contained in a finitely generated $A$-module, which finishes the proof. 
			\end{proof}
			Note $Z$ is itself a Noetherian ring and integrally closed. $\Q$ is the fraction ring of $\Z$, and finite extensions of $\Q$ are always separable. It follows (non-trivially) that
			\begin{corollary}
				$\OK$ is finitely generated over $\Z$.
			\end{corollary}
			
			Next we study the rank of $\OK$ over $\Z$. Being finitely generated is not exactly what we want.
			
			\begin{theorem}
				Let $A$ be a principal ideal ring, and $L$ a finite separable extension of its quotient field $K$, of degree $n$. Let $B$ be the integral closure of $A$ in $L$. Then $B$ is a free module of rank $n$ over $A$. 
			\end{theorem}
		
			\begin{proof}
				Since $A$ is contained in $K$, $B$ is contained in $L$, whenever $ab=0$ with $a \in A$, $b \in B$, we have $a=0$ or $b=0$. Hence $B$ is torsion-free. Therefore as a finitely generated (theorem \ref{closure-f-g}) torsion-free module, $B$ is a free module over $A$ \href{http://du.ac.in/du/uploads/departments/mathematics/study-material/MMATH18-201\%20_MT_PID.pdf}{[Theorem 2.7]}. Since $L$ is a $n$-dimensional vector space over $K$, for $y \in L$ we have
				\[
					y = c_1e_1+\cdots+c_ne_n
				\]
				where $e_1,\dots,e_n$ is a basis and $c_1,\cdots,c_n \in K$. When $y \in B$, we must have $c_1,\cdots,c_n \in A$, which is to say $B$ has rank $[L:K]=n$.
			\end{proof}
			Hence the rank of $\OK$ over $\Z$ is determined by $[K:\Q]$.
		
		\subsection{Localisation}
		
			\begin{theorem}\label{int-clo-loc}
				Let $A \subset B$ be rings, and $S$ a multiplicatively closed subset of $A$. If $B$ is integral over $A$, then $S^{-1}B$ is integrally closed in $S^{-1}A$. If $C$ is the integral closure of $A$ in $B$, then $S^{-1}C$ is the integral closure of $S^{-1}A$. 
			\end{theorem}
		
			\begin{proof}
				First we assume $B$ is integral over $A$. Pick $x/s \in S^{-1}B$ with $x \in B$ and $s \in S$. By definition we have
				\[
					x^n + a_1x^{n-1}+\cdots + a_n = 0
				\]
				with $a_i \in A$. Multiplying by $(1/s)^n$ gives
				\[
					(x/s)^n + (a_1/s)(x/s)^{n-1}+\cdots+a_n/s^n = 0
				\]
				which shows that $x/s$ is integral over $S^{-1}A$. Hence the first statement is proved. \\
				Now we assume $C$ is the integral closure of $A$ in $B$. By the first statement we see $S^{-1}C$ is integral over $S^{-1}A$. Suppose $b/s \in S^{-1}B$ is integral over $S^{-1}A$, we have an equation of the form
				\[
					(b/s)^n+(a_1/s_1)(b/s)^{n-1}+\cdots+a_n/s_n=0.
				\]
				Multiplying by $(st)^n$ where $t=s_1\cdots s_n$ gives an equation of integral independence for $bt$ over $A$. Hence $bt \in C$. But $b/s = bt/st$, hence $b/s \in S^{-1}C$ and we are done. 
			\end{proof}
		
			If $S$ happens to be a complement of a prime ideal $\mfk{p}$, we have a satisfying result
			
			\begin{corollary}\label{int-loc}
				If $B$ is integral over $A$, then $B_\mfk{p}$ is integral over $A_\mfk{p}$.
			\end{corollary}
			
			If $B$ is replaced by a field extension $L$ of the quotient field of $A$, and $C$ is replaced by the integral closure of $A$, we have the following corollary:
			
			\begin{corollary}
				If $B$ is the integral closure of $A$ in some field extension $L$ of the quotient field of $A$, then $S^{-1}B$ is the integral closure of $S^{-1}A$ in $L$.
			\end{corollary}
			
			Being integrally closed is also a local property. And we will use it to prove that the algebraic integers in the field $\Q(\omega)$ is $\Z[\omega]$.
			\begin{corollary}
				Let $A$ be an integral domain. Then the following are equivalent:
				\begin{enumerate}
					\item $A$ is integrally closed.
					\item $A_\mfk{p}$ is integrally closed for each prime ideal $\mfk{p}$. 
					\item $A_\mfk{m}$ is integrally closed for each maximal ideal $\mfk{m}$.
				\end{enumerate}
			\end{corollary}
		
			\begin{proof}
				Let $K$ be the quotient field of $A$, let $C$ be the integral closure of $A$ in $K$, and let $f:A \to C$ be the canonical embedding. Then $A$ is integrally closed if and only if $f$ is surjective.
				
				On the other hand, by theorem \ref{int-clo-loc}, $A_\mfk{p}$ (respectively $A_\mfk{m}$) is integrally closed if and only if $f_\mfk{p}$ (respectively $f_\mfk{m}$) is surjective.
				
				However, a $A$-module homomorphism $\phi:M \to N$ being surjective is a local property \href{https://www.maths.usyd.edu.au/u/de/AGR/CommutativeAlgebra/pp600-610.pdf}{[proof]}. Therefore we have
				\[
					\begin{aligned}
						A \text{ is integrally closed } &\iff f \text{ is surjective } \\
														&\iff f_\mfk{p} \text{ is surjective } \iff A_\mfk{p} \text{ is integrally closed } \\
														&\iff f_\mfk{m} \text{ is integrally closed } \iff A_\mfk{m} \text{ is integrally closed.}
					\end{aligned}
				\]
			\end{proof}
			
			% TODO: ADD SOME EXAMPLES
		\subsection{Prime Ideals}
			By theorem \ref{closure-f-g}, $\OK$ is a finitely-generated $\Z$-module, hence is a Noetherian domain. By transitivity of integral closures, $\OK$ is integrally closed. We are now interested in the Krull dimension of $\OK$. To do this, we investigate more of the prime ideal with respect to integral closure. 
			\begin{definition}
				Let $B$ be a ring containing a ring $A$. Let $\mfk{p}$ be a prime ideal of $A$ and $\mfk{P}$ a prime ideal of $B$. We say that $\mfk{P}$ \textbf{lies above} $\mfk{p}$ if $\mfk{P} \cap A = \mfk{p}$ and we then write $\mfk{P}|\mfk{p}$.
			\end{definition}
			
			If $\mfk{P}|\mfk{p}$, we have a commutative diagram:
			\[
			\begin{tikzcd}
				B \arrow[r, "\pi'"]               & B/\mathfrak{P}                  \\
				A \arrow[r, "\pi"] \arrow[u, "i"] & A/\mathfrak{p} \arrow[u, "i'"']
			\end{tikzcd}
			\]
			where $i$ and $i'$ are inclusions, $\pi$ and $\pi'$ are canonical homomorphisms. \\
			If $B$ is integral over $A$, then $B/\mfk{P}$ is integral over $A/\mfk{p}$, this is because of the following lemma if we take $\sigma$ to be $\pi$:
			\begin{lemma}
				Let $A \subset B$ be rings, and $\sigma:B \to C$ be a homomorphism. If $B$ is integral over $A$, then $\sigma(B)$ is integral over $\sigma(A)$.
			\end{lemma}
			\begin{proof}
				If $B$ is integral over $A$, then for any $x \in B$ there is an equation
				\[
				x^n + a_{n-1}x^{n-1}+\cdots+a_0 = 0.
				\]
				Therefore
				\[
				\begin{aligned}
					\sigma(x^n+a_{n-1}x^{n-1}+\cdots+a_0) &= \sigma(x^n)+\sigma(a_{n-1}x^{n-1})+\cdots+\sigma(a_0) \\
					&= \sigma(x)^n + \sigma(a_{n-1})\sigma(x)^{n-1}+\cdots+\sigma(\sigma) \\
					&= 0.
				\end{aligned}
				\]
				Hence $\sigma(x)$ is integral in $\sigma(A)$.
			\end{proof}
			
			We want to show that prime ideals of $\OK$ is maximal, and they should be corresponded to prime ideals in $\Z$, which is maximal. For this reason we show the existence of lying-above prime ideals.
			
			\begin{theorem}\label{lying-above}
				Let $A$ be a ring, $\mfk{p}$ a prime ideal, and $B \supset A$ integral over $A$. Then $\mfk{p}B \ne B$, and there exists a prime ideal $\mfk{P}$ of $B$ lying above $\mfk{p}$. 
			\end{theorem}
			
			\begin{proof}
				We know that $B_\mfk{p}$ is integral over $A_\mfk{p}$ (corollary \ref{int-loc}) and that $A_\mfk{p}$ is local with maximal ideal $\mfk{m}_\mfk{p}=\mfk{p}A_\mfk{p}$. It follows that
				\[
				\mfk{p}B_\mfk{p}=\mfk{p}A_\mfk{p}B = \mfk{p}A_\mfk{p}B_\mfk{p}=\mfk{m}_\mfk{p}B_\mfk{p}.
				\]
				Hence it suffices to prove our assertion when $A$ is local. If $\mfk{p}B=B$, we have an equation
				\[
				1 = a_1b_1+\cdots+a_nb_n
				\]
				with $a_i \in \mfk{p}$ and $b_i \in B$. Let $B_0 = A[b_1,\cdots,b_n]$. Then $\mfk{p}B_0=B_0$ and $B_0$ is a finitely generated $A$-module. Hence by Nakayama's lemma, $B_0=0$, which is absurd.
				
				To prove the existence of $\mfk{P}$, consider the following commutative diagram:
				\[
				\begin{tikzcd}
					B \arrow[r]           & B_\mathfrak{p}           \\
					A \arrow[r] \arrow[u] & A_\mathfrak{p} \arrow[u]
				\end{tikzcd}
				\]
				where all arrows are natural inclusions. As is proved, $\mfk{m}_\mfk{p}B_\mfk{p} \ne B_\mfk{p}$. Hence $\mfk{m}_\mfk{p}B_\mfk{p}$ is contained in a maximal ideal $\mfk{M}$ of $\mfk{p}$, and therefore $\mfk{M} \cap A_\mfk{p}$ contains $\mfk{m}_\mfk{p}$. And we pick $\mfk{P}=\mfk{M} \cap B$. Then $\mfk{P}$ is a prime ideal of $B$, and taking intersection with $A$ going both ways around our diagram shows that $\mfk{M} \cap A = \mfk{p}$, so that
				\[
				\mfk{P} \cap A = \mfk{p},
				\]
				as was to be shown.
			\end{proof}
			
			Now we proceed to the crucial theorem to determine whether a prime lying above is maximal.
			
			\begin{theorem}\label{lie-above-maximal}
				Let $A$ be a subring of $B$, and assume $B$ is integral over $A$. Let $\mfk{P}$ be a prime ideal of $B$ lying over a prime ideal $\mfk{p}$ of $A$. Then $\mfk{P}$ is maximal $\iff$ $\mfk{p}$ is maximal.
			\end{theorem}
			
			\begin{proof}
				$\implies$: Note $B/\mfk{P}$ is a field and is integral over the ring $A/\mfk{p}$. Were $A/\mfk{p}$ not a field, there would be a non-trivial ideal $\mfk{m}$ of it, and $B/\mfk{P}$ would have a prime ideal $\mfk{M}$ lying above $\mfk{m}$, by theorem \ref{lying-above}. A contradiction. \\
				$\impliedby$: Note $A/\mfk{p}$ is a field. It suffices to prove that a ring $R$ which is integral over a field $k$ is a field. If $k$ is a field and non-zero $x \in R$ is integral over $k$, we have a minimal polynomial
				\[
				x^n+c_{n-1}y^{n-1}+\cdots+c_0=0
				\]
				with $c_i \in k$. Since $R$ is integral, we have $c_0 \ne 0$. We can clearly write
				\[
				x^{-1}=-c_0^{-1}(x^{n-1}+c_{n-1}y_{n-2}+\cdots+c_1) \in R,
				\]
				which is to say $R$ is integral, and the theorem is therefore proved.
			\end{proof}
			With respect to localisation, we can show the stability of prime ideals lying above:
			\begin{corollary}
				Let $A \subset B$ be rings, $B$ integral over $A$; Let $\mfk{P}$ and $\mfk{P}'$ be prime ideals of $B$ such that $\mfk{P} \subset \mfk{P}'$ and both $\mfk{P}$ and $\mfk{P}'$ lie above a prime ideal $\mfk{p}$ of $A$, then $\mfk{P}=\mfk{P}'$. 
			\end{corollary}
			\begin{proof}
				By corollary \ref{int-loc}, $B_\mfk{p}$ is integral over $A_\mfk{p}$. Let $\mfk{m}$ be the extension of $\mfk{p}$ in $A_\mfk{p}$ and $\mfk{M},\mfk{M}'$ be the extensions of $\mfk{P}$ and $\mfk{P}'$ respectively in $B_\mfk{p}$. Then $\mfk{m}$ is the maximal ideal of $A_\mfk{p}$; $\mfk{M} \subset \mfk{M}'$, and $\mfk{M}$, $\mfk{M}'$ lies above $\mfk{m}$. Hence by theorem \ref{lie-above-maximal}, $\mfk{M}$ and $\mfk{M}'$ are both maximal, hence equal. This reduces to $\mfk{P}=\mfk{P}'$.
			\end{proof}
			And now we are ready to prove that $\OK$ is Dedekind.
			
			\begin{theorem}\label{o_k-dedekind}
				Every prime ideal $\mfk{P}$ in $\OK$ is maximal. Hence $\OK$ is of Krull dimension $1$ and is therefore Dedekind.
			\end{theorem}
			
			\begin{proof}
				Note it suffices to prove that every prime ideal $\mfk{P}$ of $\OK$ lies above some prime ideal of $\Z$, since $\Z$ has Krull dimension $1$, and the proof follows from theorem \ref{lie-above-maximal}. All we need to do is to prove that $\mfk{P} \cap \Z$ is non-zero: since the inverse image of a prime ideal is prime, we are done. For each $x \in \mfk{P}$, we have a minimal polynomial $f \in \Z[X]$ such that
				\[
				f(x) = x^n+c_{n-1}x^{n-1}+\cdots+c_0=0
				\]
				with $c_i \in \Z$ and $c_0 \ne 0$. It follows that
				\[
				c_0=-(x^n+c_{n-1}x^{n-1}+\cdots+c_1x) \in \mfk{P} \cap \Z,
				\]
				which is to say $\mfk{P} \cap \Z$ is indeed non-zero. This concludes the proof.
			\end{proof}
			\begin{example}
				As a classic example, consider $K=\Q(\sqrt{-5})$ and $\OK = \Z[\sqrt{-5}]$. This ring is not a unique factorial domain because we have
				\[
				6 = 2 \cdot 3 = (1-\sqrt{-5}) \cdot (1+\sqrt{-5}).
				\]
				But if we view it in the sense of product of ideals, we still have some uniqueness. Let $\mfk{m}$ be the maximal ideal containing $6$, then
				\[
				\mfk{m} = (2,1-\sqrt{-5})(2,1+\sqrt{-5})
				\]
				is unique. Note two ideals on the right hand side are indeed maximal (hence prime) because
				\[
				\begin{aligned}
					\frac{\Z[\sqrt{-5}]}{(2,1-\sqrt{-5})} &\cong \frac{\Z[X]/(X^2+5)}{(2,1-X,X^2+5)/(X^2+5)} \\
					&\cong \frac{\Z[X]}{(2,1-X,X^2+5)} \cong \frac{\Z_2[X]}{(1-X,X^2-1)} \cong \frac{\Z_2[X]}{(1-X)} \cong \Z_2.
				\end{aligned}
				\]
				Likewise,
				\[
				\begin{aligned}
					\frac{\Z[\sqrt{-5}]}{(3,1+\sqrt{-5})} &\cong \frac{\Z[X]/(X^2+5)}{(3,1+X,X^2+5)/(X^2+5)} \\
					&\cong \frac{\Z[X]}{(3,1+X,X^2+5)} \cong \frac{\Z_3[X]}{(1+X,X^2-1)} \cong \frac{\Z_3[X]}{(1+X)} \cong \Z_3.
				\end{aligned}
				\]
			\end{example}
			We will see when a Dedekind domain is UFD in the future.
	\section{Galois extensions}
		\subsection{Special subgroups of the Galois group}
			In this subsection we study the behaviour of Galois group with respect to integral closure, which can of course help us study number field and algebraic integers if we are interested in the extension itself.
		
			If $K$ is a Galois extension of $\Q$, then the Galois group allows us to transform amongst prime ideals in a natural way. This is because of the following theorem.
			\[
				\begin{tikzcd}
					\mathfrak{P} \arrow[rr, "\exists \sigma \in G"] &                                    & \mathfrak{Q} \\
					& \mathfrak{p} \arrow[lu] \arrow[ru] &             
				\end{tikzcd}
			\]
			\begin{theorem}\label{galois-lie-above}
				Let $A$ be a ring, integrally closed in its quotient field $K$. Let $L$ be a finite Galois extension of $K$ with group $G$. Let $\mfk{p}$ be a maximal ideal of $A$, and let $\mfk{P}$, $\mfk{Q}$ be prime ideals of the integral closure of $A$ in $L$ lying above $\mfk{p}$. Then there exists $\sigma \in G$ such that $\sigma\mfk{P} = \mfk{Q}$.
			\end{theorem}
			\begin{proof}
				Suppose that $\mfk{P}=\sigma\mfk{Q}$ for all $\sigma \in G$. By the Chinese remainder theorem, we have some $x \in B$ such that 
				\[
					\begin{aligned}
						x &\equiv 0 \mod \mfk{P} \\
						x &\equiv 1 \mod \sigma\mfk{Q}, \quad \forall \sigma \in G.
					\end{aligned}
				\]
				Then the norm
				\[
					N_K^L(x) = \prod_{\sigma \in G}\sigma{x}
				\]
				lies in $B \cap K = A$ since $A$ is integrally closed, and lies in $\mfk{P} \cap A = \mfk{p}=\mfk{Q} \cap A \subset \mfk{Q}$. But we also have $\sigma{x} \not\in \mfk{Q}$ for all $\sigma \in G$, hence $N_K^L(x) \not \in \mfk{Q}$, a contradiction.
			\end{proof}
			If one localise, the consideration on whether a prime ideal is maximal is not required. Besides, if $A$ is of Krull dimension $1$, then one has no need to consider as well. Since we have shown that $\OK$ is a Dedekind domain, this theorem can be applied as well. Next we show the finiteness of prime ideals lying above.
			
			\begin{corollary} 
				Let $A$ be an integrally closed domain whose field of fraction is $K$. Let $E$ be a finite separable extension of $K$, and $B$ the integral closure of $A$ in $E$. Let $\mfk{p}$ be a maximal ideal of $A$. Then there exists only a finite number of prime ideals of $B$ lying above $\mfk{p}$.
			\end{corollary}
			\begin{proof}
				 If $E$ is Galois over $K$, then by theorem \ref{galois-lie-above}, $\sigma\mfk{P}_1 = \mfk{P}_2$ for some $\sigma \in \gal(E/K)$. Suppose $\mfk{P}_1|\mfk{p}$, then the set of prime ideals lying above $\mfk{p}$ is contained in the set
				\[
					\{\mfk{Q} \subset B: \mfk{Q}=\sigma\mfk{P}_1,\sigma\in\gal(E/K)\},
				\]
				hence is finite because $\gal(E/K)$ is finite. If $E$ is not necessarily Galois, we can pick the smallest Galois extension $L/K$ containing $E$, which is a finite extension as well. Let $C$ be the integral closure of $A$ in $L$. Suppose $\mfk{P},\mfk{Q} \in \spec(B)$ are two distinct prime ideals lying above $\mfk{p}$, and $\mfk{P}',\mfk{Q}' \in \spec(C)$ lying above $\mfk{P}$ and $\mfk{Q}$ respectively. Note $\mfk{P}' \ne \mfk{Q}'$ because if not then $\mfk{P}=\mfk{Q}$, a contradiction. Therefore the distinct prime ideals of $B$ lying above $\mfk{p}$ are less than the distinct prime ideals of $C$ lying above $\mfk{p}$, which proves our assertion.
				\[
					\begin{tikzcd}
						\mathfrak{P}'          &                                    & \mathfrak{Q}'          & C                   \\
						\mathfrak{P} \arrow[u] &                                    & \mathfrak{Q} \arrow[u] & B \arrow[u, dashed] \\
						& \mathfrak{p} \arrow[lu] \arrow[ru] &                        & A \arrow[u, dashed]
					\end{tikzcd}
				\]
			\end{proof}
			\begin{example}\label{gauss-int-1}
				Now take $K=\Q(i)$, $\OK=\Z[i]$ and $\mfk{p}=(5)$. Since $\gal(K/\Q)=\{1,\sigma\}$ where $\sigma$ is the complex conjugation, there are at most two prime ideals lying above $\mfk{p}$. First of all $5\Z[i]$ is not prime because 
				\[
					5+0i = (2-i)(2+i).
				\]
				Since $\Z[i]$ is a PID, we only need to consider Gaussian integers that divide $5$. Keeping in mind that $\Z[i]$ is also an Euclidean domain, we have two non-trivial solutions up to units in $\Z[i]$:
				\[
					5 = (2-i)(2+i).
				\]
				
				As ideals, we have $(2-i)=(1+2i)=(-2+i)$. Since $2-i$ is irreducible in $\Z[i]$, we have found a prime ideal $\mfk{P}=(2-i)$ lies above $\mfk{p}$, and $\mfk{P}'=\sigma\mfk{P}=(2+i)$ has to be the remaining one. Note we have also established the factorisation of $5\Z[i]$ in the Dedekind domain $\OK$.
					
			\end{example}
		
			This example also shows that the norm defined in theorem \ref{galois-lie-above} makes sense, because we have
			\[
			N_{\Q}^{K}(a+bi)=\prod_{\sigma \in \gal(K/\Q)}\sigma(a+bi) = (a+bi)(a-bi)=a^2+b^2.
			\]
			We will study norm extensively in the future. %TODO: add reference if it is needed.
			
			Let $A$ be an integrally closed ring with quotient field $K$, and $B$ its integral closure in a finite Galois extension $L$. Then firstly $\sigma{B}=B$ for all $\sigma \in \gal(L/K)$ (Proof: $\sigma{B} \subset L$ is integral over $\sigma{A}=A$, hence has to be $B$ itself). Automorphisms fixing base field give rise to Galois group, and now we are interested in automorphisms that also fix ideals. 
			
			\subsubsection{Decomposition groups and fields}
			
				\begin{definition}
					Notations being above, let $\mfk{p}$ be a maximal ideal of $A$, $\mfk{P}$ maximal in $B$ lying above $\mfk{p}$. Then the subgroup
					\[
						G_\mfk{P} = \{\sigma \in \gal(L/K):\sigma\mfk{P}=\mfk{P}\}
					\]
					is called the \textbf{decomposition group} of $\mfk{P}$. Its fixed field will be denoted by $L^d$, and will be called the \textbf{decomposition field} of $\mfk{P}$. 
				\end{definition}
				Two non-trivial examples are given, abelian and non-abelian. We will frequently return to these examples after new concepts are introduced. 
				% TODO: expand details of these two examples.
				\begin{example}
					Consider $K = \Q(\sqrt{-1},\sqrt{2},\sqrt{5})$, whose Galois group is isomorphic to $\Z/2\Z \times \Z/2\Z \times \Z/2\Z$. The decomposition field of $(5)$ is
					\[
						K^d = \Q(\sqrt{-1},\sqrt{2}).
					\]
				\end{example}
				\begin{example}
					Consider $K = \Q(\sqrt[3]{19},\omega)$ where $\omega = e^{2\pi i/3}$. The Galois group is $S_3$. The decomposition fields of $(3)$ are
					\[
						\Q(\sqrt[3]{19}),\quad \Q(\omega\sqrt[3]{19}),\quad\Q(\omega^2\sqrt[3]{19}).
					\]
					At this point we can only compute the field manually but after introducing ramification index things are much easier. 
				\end{example}
			
				It is natural to think whether a decomposition group is normal, when the Galois group is non-abelian. For this question we have an pretty elegant result. 
				
				\begin{theorem}
					Notation still being above, the decomposition group of $\sigma\mfk{P}$ where $\sigma \in \gal(L/K)$ is $\sigma G_\mfk{P}\sigma^{-1}$, i.e.
					\[
						G_{\sigma\mfk{P}} = \sigma G_\mfk{P}\sigma^{-1}.
					\]
				\end{theorem}
				This theorem says, the Galois group acting on itself by conjugation yields all decomposition groups of primes of $B$ lying above a certain prime of $A$.
				\begin{proof}
					We can write $\gal(L/K) = \bigcup\sigma_jG_\mfk{P}$ as a coset decomposition. We claim this decomposition determines distinct prime ideals lying above $\mfk{p}$. Note
					\[
						\sigma\mfk{P}=\tau\mfk{P} \iff \tau^{-1}\sigma\mfk{P}=\mfk{P} \iff \tau^{-1}\sigma \in G_\mfk{P}
					\]
					which is equivalent to say $\tau$ and $\sigma$ lie in the same coset mod $G_\mfk{P}$. 
					
					This claim actually proves this theorem. On one hand, pick $\lambda \in G_\mfk{P}$, then
					\[
						\sigma\lambda\mfk{P} = \sigma\lambda\sigma^{-1}\sigma\mfk{P} = \sigma\mfk{P}
					\]
					Hence $\sigma G_{\mfk{P}}\sigma^{-1} \subset G_{\sigma\mfk{P}}$. Note we have used the fact that $\sigma\lambda,\sigma \in \sigma G_\mfk{P}$. 
					
					On the other hand, if $\lambda\sigma\mfk{P} = \sigma\mfk{P}$, we have $\lambda\sigma \in \sigma G_\mfk{P}$, hence $\lambda \in \sigma G_\mfk{P}\sigma^{-1}$, which is equivalent to say $G_{\sigma\mfk{P}} \subset \sigma G_\mfk{P} \sigma^{-1}$.
				\end{proof}
			
				As for the field, we have a pretty concrete result:
					
				\begin{theorem}
					Assume $L/K$ is Galois and finite. The field $L^d$ is the smallest $E$ subfield of $L$ containing $K$ such that $\mfk{P}$ is the only prime of $B$ lying above $\mfk{P} \cap E$. 
				\end{theorem}
				\begin{proof}
					Let $E$ be the smallest subfield of $L$ satisfying the property above, and write $\mfk{q} = \mfk{P} \cap E$. By the fundamental theorem of Galois theory ($L/E$ is Galois) and theorem \ref{galois-lie-above}, prime ideals of $B$ lying above $\mfk{q}$ differs by an element of $\gal(L/E)$. But by assumption there is only one such prime $\mfk{P}$, hence $H \subset G_\mfk{P}$ and therefore $E \supset L^d$.
					
					On the other hand, let $B^d$ be the integral closure of $A$ in $L^d$ (which is Dedekind as well), and let $\mfk{Q}=\mfk{P} \cap B^d$. By theorem \ref{galois-lie-above}, $\mfk{P}$ is the only prime of $B$ lying above $\mfk{Q}$ in $B^d$. Hence $E \subset L^d$, which proves the theorem.
				\end{proof}
				
				We are not done yet: the result can be even much sharpener:
				
				\begin{theorem}
					Notation being above, the canonical injection $\varphi:A/\mfk{p} \to B^d/\mfk{Q}$ is an isomorphism.
				\end{theorem}
				
				\begin{proof}
					First of all we clarify what we mean by canonical injection:
					\[
						\varphi:x + \mfk{p} \mapsto x + \mfk{Q}.
					\]
					
					This is indeed injective because if if $\varphi(x+\mfk{p})=\mfk{Q}$, we have $x \in \mfk{Q}$. This gives
					\[
						x \in \mfk{Q} \cap A = (\mfk{P} \cap A) \cap B^d = \mfk{p} \cap B^d = \mfk{p}.
					\]
					
					It remains to prove that $\varphi$ is surjective. Given $x + \mfk{Q} \in B^d/\mfk{Q}$, we need to find an element $z \in A$ such that $\varphi(z) = x + \mfk{Q}$. 
					
					Pick $\sigma \in \gal(L/K) \setminus G_\mfk{P}$. Let
					\[
						\mfk{Q}_\sigma = \sigma^{-1}\mfk{P} \cap B^d.
					\]
					Then $\mfk{Q}_\sigma \ne \mfk{Q}$ (note $\mfk{P}$ is assumed to be maximal hence so are $\mfk{Q}$ and $\mfk{Q}_\sigma$). Let $x$ be an element of $B^d$. By Chinese remainder theorem, there exists an element $y \in B^d$ such that
					\[
						\begin{aligned}
							y &\equiv x \mod \mfk{Q}, \\
							y &\equiv 1 \mod \mfk{Q}_\sigma.
						\end{aligned}
					\]
					Hence in particular,
					\[
						\begin{aligned}
							y &\equiv x \mod \mfk{P}, \\
							y &\equiv 1 \mod \sigma^{-1}\mfk{P}.
						\end{aligned}
					\]
					The second congruence gives
					\[
						\sigma{y} \equiv 1 \mod \mfk{P}.
					\]
					Note this holds for all $\sigma \not \in G_\mfk{P}$. For $\lambda \in G_\mfk{P}$, we have $\sigma{y}=y \equiv x \mod \mfk{Q}$. Thus we obtain
					\[
						z=N_K^L(y) \equiv x \mod \mfk{P}.
					\]
					First of all $z \in K$ by definition of norm. Since $z$ is integral over $A$, it has to be an element in $A$. We also have % TODO: 'definition of norm' deserves more explanation.
					\[
						z \equiv x \mod \mfk{Q}
					\]
					because both $z$ and $x$ lie in $B^d$. Hence we obtain $\varphi(z) = x + \mfk{P}$ as we wanted.
				\end{proof}
				
				% TODO: examples.
			
			\subsubsection{Inertia groups and fields}
				We are concerned about the homomorphism induced by the decomposition group.
				\begin{theorem}
					Notation still being above, $\overline{B}=B/\mfk{P}$ is a normal extension of $\overline{A}=A/\mfk{p}$, and the map $\sigma \to \overline{\sigma}$ induces a homomorphism of $G_\mfk{P}$ onto $\gal(\overline{B}/\overline{A})$
				\end{theorem}
				\begin{proof}
					% TODO: Proof.
				\end{proof}
				This enables us to work on algebraic closure with some ease:
				\begin{corollary}
					Let $\phi:A \to A/\mfk{p}$ be the canonical homomorphism, and let $\psi_1$, $\psi_2$ be two homomorphisms of $B$ extending $\varphi$ in a given algebraic closure of $A/\mfk{p}$. Then there exists an automorphism $\sigma$ of $L$ over $K$ such that
					\[
						\psi_1 = \psi_2 \circ \sigma
					\]
				\end{corollary}
				\begin{proof}
					% TODO: Proof.
				\end{proof}
			
				\begin{definition}
					Let $\overline{G}_\mfk{P}$ be the automorphism group of $B/\mfk{P}$. The kernel of the map
					\[
						G_\mfk{P} \to \overline{G}_\mfk{P}
					\]
					is called the inertia group. That is, these elements induce the trivial automorphism in $B/\mfk{P}$.
				\end{definition}
		\subsection{Automorphisms}
	\section{Dedekind domain}
	
		\subsection{Operations of ideals}
		% TODO: Daniel Chapter 3.
		\subsection{Ramification index}
		
		\subsection{The norm and trace}
			We used the concept of norm and trace at the very beginning. Here is a good chance to study them extensively. Recall for $\mathds{C}$ and $\mathds{R}$ we have a natural faithful representation
			\[
				\begin{aligned}
					\rho:\mathds{C} &\to End(\mathds{R}^2) \\
							a+bi   &\mapsto \begin{pmatrix} a & -b \\ b & a \end{pmatrix}.
				\end{aligned}
			\]
			Note $|\rho(a+bi)|=a^2+b^2$, which is pretty close to the norm in analysis. It is not a good idea to take square root in the sense of algebra so we directly use the determinant. We will also be using trace of such matrices.
			\begin{definition}
				Let $E$ be a finite extension of $k$, which we view as a finite dimensional vector space over $k$. Each $\alpha \in E$ induces a linear map by multiplication:
				\[
					\begin{aligned}
						m_\alpha : E &\to E \\
								x &\mapsto \alpha{x}.
					\end{aligned}
				\]
				We define the norm and trace from $E$ to $k$ by
				\[
					\det(m_\alpha)=N_k^E(\alpha), \quad \tr(m_\alpha)=\tr_k^E(\alpha).
				\]
			\end{definition}
			
			Note this has nothing to do with norm in the sense of topology. The reason is, the norm lies in $k$, which is an arbitrary field. And a field alone has nothing to do with real numbers. Besides, consider the group field $\Q(\sqrt{2})/\Q$. In this field, the we have the matrix representation of $1+\sqrt{2}$ to be
			\[
				1+\sqrt{2} \mapsto \begin{pmatrix} 1 & 2 \\ 1 & 1 \end{pmatrix}
			\]
			whose determinant is $-1$. It makes little sense to compare this to norm in topology.
		
			% TODO: formula of norm and trace.
			% TODO: further properties.
		\subsection{Discrete valuation rings}
			A \textbf{discrete valuation ring} can be considered as a localisation of Dedekind domain. Indeed, if $A$ is a discrete valuation ring, then $A$ is Noetherian and of Krull dimension $1$, and is integrally closed, hence Dedekind. If $A$ is local and Dedekind, then $A$ is a discrete valuation ring. In general, a Noetherian domain $A$ of Krull dimension one is Dedekind if and only if the localisation $A_\mfk{p}$ is a discrete valuation ring for all prime $\mfk{p}$. With respect to localisation we have a natural result:
			\begin{theorem}
				Let $A$ be a Dedekind ring and $M,N$ two modules over $A$. If $M_\mfk{p} \subset N_\mfk{p}$ for all prime $\mfk{p}$, then $M \subset N$.
			\end{theorem}
			\begin{proof}
				Let $a \in M$. For each $\mfk{p}$ we can find $x_\mfk{p} \in N$ and $s_\mfk{p} \in A \setminus \mfk{p}$ such that $a = x_\mfk{p}/s_\mfk{p}$. Let $\mfk{b}$ be the ideal generated by the $s_\mfk{p}$, ranging through all $\mfk{p} \in \spec(A)$. Then $\mfk{b}$ is the unit ideal $A$, and we can write
				\[
					1 = \sum_{\mfk{p} \in \spec(A)} y_\mfk{p}s_\mfk{p}
				\]
				with elements $y_\mfk{p} \in A$ all but a finite number of which are $0$. This yields
				\[
					a = \sum_{\mfk{p} \in \spec(A)} y_\mfk{p}s_\mfk{p}a = \sum_{\mfk{p} \in \spec(A)} y_\mfk{p}x_\mfk{p} \in N
				\]
				as desired.
			\end{proof}
		
			Now we study torsion-free modules over a discrete valuation ring. If $A$ is a discrete valuation ring, then in particular, $A$ is a principal ideal ring, and any finitely generated torsion-free module $M$ over $A$ is free. If its rank is $n$, and if $\mfk{p}$ is the maximal idea, then $M/\mfk{p}M$ is a free module of rank $n$. Further, we have
			\begin{theorem}
				Let $A$ be a local ring and $M$ a free module of rank $n$ over $A$. Let $\mfk{p}$ be the maximal ideal of $A$. Then $M/\mfk{p}M$ is a vector space of dimension $n$ over $A/\mfk{p}$.
			\end{theorem}
			\begin{proof}
				Let $\{x_1,\dots,x_n\}$ be a basis of $M$ over $A$, then
				\[
					M \cong \bigoplus_{i}Ax_i
				\]
				and
				\[
					M/\mfk{p}M \cong \bigoplus_{i}(A/\mfk{p})\overline{x}_i
				\]
				where $\overline{x}_i$ is the residue class of $x_i$ mod $\mfk{p}$.
			\end{proof}
